CREATE TABLE VAITRO (
    MAVT CHAR(8) PRIMARY KEY,
    TENVAITRO VARCHAR2(20) NOT NULL
);

CREATE TABLE QUYEN (
    MAQUYEN CHAR(8) PRIMARY KEY,
    TENQUYEN CHAR(50) NOT NULL
);

CREATE TABLE VAITRO_QUYEN (
    MAVT CHAR(8),
    MAQUYEN CHAR(8),
    CONSTRAINT PK_VAITRO_QUYEN PRIMARY KEY (MAVT, MAQUYEN),
    CONSTRAINT FK_VQ_VAITRO FOREIGN KEY (MAVT) REFERENCES VAITRO(MAVT),
    CONSTRAINT FK_VQ_QUYEN FOREIGN KEY (MAQUYEN) REFERENCES QUYEN(MAQUYEN)
);
CREATE TABLE NHANVIEN (
   MANV CHAR(8) PRIMARY KEY,
   HOTEN VARCHAR2(50),
   CCCD VARCHAR2(12) UNIQUE,  
   SDT VARCHAR2(10),
   MAVT CHAR(8) NOT NULL,
   MASOTHUE VARCHAR2(15),
   CONSTRAINT FK_TK_VT FOREIGN KEY (MAVT) REFERENCES VAITRO(MAVT)
);
CREATE TABLE TAIKHOAN (
   USERNAME VARCHAR2(50) PRIMARY KEY,
   MATKHAU VARCHAR2(255),
   EMAIL VARCHAR2(100) UNIQUE,
   MANV CHAR(8) UNIQUE,
   CONSTRAINT FK_TK_NV FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)
);

CREATE TABLE KHACHHANG (
   MAKH CHAR(8) PRIMARY KEY,
   HOTEN VARCHAR2(100),
   DIEMTICHLUY NUMBER,
   LOAIKHACH VARCHAR2(50), 
   SDT VARCHAR2(10)
);

CREATE TABLE NHACUNGUNG (
   MANCU CHAR(8) PRIMARY KEY,
   TENNCU VARCHAR2(100),
   MASOTHUE VARCHAR2(15),
   DIACHI VARCHAR2(255),
   SDT VARCHAR2(10),
   EMAIL VARCHAR2(80)
);

CREATE TABLE HANGSANXUAT (
   MAHSX CHAR(8) PRIMARY KEY,
   TENHSX VARCHAR2(100) NULL,
   MASOTHUE VARCHAR2(15) NULL,
   DIACHI VARCHAR2(255) NULL,
   SDT VARCHAR2(10) NULL
);

CREATE TABLE LOAISANPHAM (
   MALSP CHAR(8) PRIMARY KEY,
   TENLSP VARCHAR2(100)
);

CREATE TABLE SANPHAM (
   MASP CHAR(8) PRIMARY KEY,
   MAHSX CHAR(8),
   MALSP CHAR(8),
   TENSP VARCHAR2(100),
   QUYCACHDONGGOI VARCHAR2(50),
   SODANGKY CHAR(20),
   SOLUONG NUMBER,
   GIABAN NUMBER(18,2),
   CONSTRAINT FK_SP_LSP FOREIGN KEY (MALSP) REFERENCES LOAISANPHAM(MALSP),
   CONSTRAINT FK_SP_HSX FOREIGN KEY (MAHSX) REFERENCES HANGSANXUAT(MAHSX)
);

CREATE TABLE PHIEUNHAPHANG (
   MAPNH CHAR(8) PRIMARY KEY,
   MANCU CHAR(8),
   MANV CHAR(8),
   NGAYLAPPHIEU DATE,
   THANHTIEN NUMBER(18,2),
   CONSTRAINT FK_PNH_NCU FOREIGN KEY (MANCU) REFERENCES NHACUNGUNG(MANCU),
   CONSTRAINT FK_PNH_NV FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)
);

CREATE TABLE CHITIETPHIEUNHAPHANG (
   MAPNH CHAR(8) NOT NULL,
   MASP CHAR(8) NOT NULL,
   HSD DATE,
   SOLO VARCHAR2(50),
   SLNHAP NUMBER NOT NULL,
   GIANHAP NUMBER(18,2) NOT NULL,
   PRIMARY KEY (MAPNH, MASP),
   CONSTRAINT FK_CTPNH_PNH FOREIGN KEY (MAPNH) REFERENCES PHIEUNHAPHANG(MAPNH),
   CONSTRAINT FK_CTPNH_SP FOREIGN KEY (MASP) REFERENCES SANPHAM(MASP),
   CONSTRAINT CHK_CTPNH_SL CHECK (SLNHAP > 0),
   CONSTRAINT CHK_CTPNH_GIA CHECK (GIANHAP >= 0)
);
CREATE TABLE HOADON (
   MAHD CHAR(8) PRIMARY KEY,
   MANV CHAR(8),
   MAKH CHAR(8),
   NGAYBAN DATE,
   THANHTIEN NUMBER(18,2),
   TRANGTHAI VARCHAR2(20) DEFAULT 'BINH_THUONG',
   CONSTRAINT FK_HD_NV FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV),
   CONSTRAINT FK_HD_KH FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH)
);

CREATE TABLE CHITIETHOADON (
   MAHD CHAR(8) NOT NULL,
   MASP CHAR(8) NOT NULL,
   SOLUONG NUMBER NOT NULL,
   GIA NUMBER(18,2) NOT NULL,
   PRIMARY KEY (MAHD, MASP),
   CONSTRAINT FK_CTHD_HD FOREIGN KEY (MAHD) REFERENCES HOADON(MAHD),
   CONSTRAINT FK_CTHD_SP FOREIGN KEY (MASP) REFERENCES SANPHAM(MASP),
   CONSTRAINT CHK_CTHD_SOLUONG CHECK (SOLUONG > 0),
   CONSTRAINT CHK_CTHD_GIA CHECK (GIA > 0)
);

ALTER TABLE KHACHHANG 
MODIFY LOAIKHACH VARCHAR2(50) DEFAULT 'Bình thường';

ALTER TABLE KHACHHANG
MODIFY DIEMTICHLUY NUMBER DEFAULT 0;

ALTER TABLE NHANVIEN 
ADD TRANGTHAI VARCHAR2(20) DEFAULT 'ĐANG LÀM'; 

ALTER TABLE SANPHAM 
ADD TRANGTHAI VARCHAR2(20) DEFAULT 'ĐANG BÁN'; 

ALTER TABLE LOAISANPHAM 
ADD TRANGTHAI VARCHAR2(20) DEFAULT 'ĐANG SỬ DỤNG'; 

ALTER TABLE NHACUNGUNG 
ADD TRANGTHAI VARCHAR2(20) DEFAULT 'ĐANG HỢP TÁC'; 

ALTER TABLE HANGSANXUAT 
ADD TRANGTHAI VARCHAR2(20) DEFAULT 'ĐANG SỬ DỤNG';

-- VAITRO
INSERT INTO VAITRO VALUES ('VT001', 'Chủ');
INSERT INTO VAITRO VALUES ('VT002', 'Quản lý');
INSERT INTO VAITRO VALUES ('VT003', 'Bán hàng');

--QUYEN
INSERT INTO QUYEN VALUES ('Q001', 'Xem sản phẩm');
INSERT INTO QUYEN VALUES ('Q002', 'Thêm sản phẩm');
INSERT INTO QUYEN VALUES ('Q003', 'Sửa sản phẩm');
INSERT INTO QUYEN VALUES ('Q004', 'Xóa sản phẩm');

INSERT INTO QUYEN VALUES ('Q005', 'Xem loại sản phẩm');
INSERT INTO QUYEN VALUES ('Q006', 'Thêm loại sản phẩm');
INSERT INTO QUYEN VALUES ('Q007', 'Sửa loại sản phẩm');
INSERT INTO QUYEN VALUES ('Q008', 'Xóa loại sản phẩm');

INSERT INTO QUYEN VALUES ('Q009', 'Xem nhà cung ứng');
INSERT INTO QUYEN VALUES ('Q010', 'Thêm nhà cung ứng');
INSERT INTO QUYEN VALUES ('Q011', 'Sửa nhà cung ứng');
INSERT INTO QUYEN VALUES ('Q012', 'Xóa nhà cung ứng');

INSERT INTO QUYEN VALUES ('Q013', 'Xem hãng sản xuất');
INSERT INTO QUYEN VALUES ('Q014', 'Thêm hãng sản xuất');
INSERT INTO QUYEN VALUES ('Q015', 'Sửa hãng sản xuất');
INSERT INTO QUYEN VALUES ('Q016', 'Xóa hãng sản xuất');

INSERT INTO QUYEN VALUES ('Q017', 'Xem nhân viên');
INSERT INTO QUYEN VALUES ('Q018', 'Thêm nhân viên');
INSERT INTO QUYEN VALUES ('Q019', 'Sửa nhân viên');
INSERT INTO QUYEN VALUES ('Q020', 'Xóa nhân viên');

INSERT INTO QUYEN VALUES ('Q021', 'Xem khách hàng');
INSERT INTO QUYEN VALUES ('Q022', 'Thêm khách hàng');
INSERT INTO QUYEN VALUES ('Q023', 'Sửa khách hàng');
INSERT INTO QUYEN VALUES ('Q024', 'Xóa khách hàng');

INSERT INTO QUYEN VALUES ('Q025', 'Xem phiếu nhập hàng');
INSERT INTO QUYEN VALUES ('Q026', 'Thêm phiếu nhập hàng');
INSERT INTO QUYEN VALUES ('Q027', 'Sửa phiếu nhập hàng');
INSERT INTO QUYEN VALUES ('Q028', 'Xóa phiếu nhập hàng');

INSERT INTO QUYEN VALUES ('Q029', 'Xem hóa đơn');
INSERT INTO QUYEN VALUES ('Q030', 'Thêm hóa đơn');
INSERT INTO QUYEN VALUES ('Q031', 'Sửa hóa đơn');
INSERT INTO QUYEN VALUES ('Q032', 'Xóa hóa đơn');

INSERT INTO QUYEN VALUES ('Q033', 'Xem doanh thu');
INSERT INTO QUYEN VALUES ('Q034', 'Xem HSD');


--VAITRO-QUYEN
--CHU
BEGIN
  FOR i IN 1..33 LOOP
    INSERT INTO VAITRO_QUYEN (MAVT, MAQUYEN) VALUES ('VT001', 'Q' || LPAD(i, 3, '0'));
  END LOOP;
END;
/
INSERT INTO VAITRO_QUYEN VALUES ('VT001', 'Q034');

--QUAN LY
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q001');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q002');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q003');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q004');

INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q005');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q006');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q007');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q008');

INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q009');

INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q013');

INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q017'); 

INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q021');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q022');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q023');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q024');

INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q025');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q026');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q027');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q028');

INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q029');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q030');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q031');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q032');

INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q033');
INSERT INTO VAITRO_QUYEN VALUES ('VT002', 'Q034');

--BAN HANG

INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q001');
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q005');
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q009'); 
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q013');
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q017');
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q021'); 
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q022');
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q025');
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q029'); 
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q030');
INSERT INTO VAITRO_QUYEN VALUES ('VT003', 'Q034');

--NHANVIEN
INSERT INTO NHANVIEN (MANV, HOTEN, CCCD, SDT, MAVT, MASOTHUE) VALUES ('CH001', 'Admin', '001100999999', '0967890000', 'VT001', '779127777');
INSERT INTO NHANVIEN (MANV, HOTEN, CCCD, SDT, MAVT, MASOTHUE) VALUES ('NV001', 'Đinh Nguyễn Khánh Quỳnh', '001100110011', '0901234567', 'VT002', '123456789');
INSERT INTO NHANVIEN (MANV, HOTEN, CCCD, SDT, MAVT, MASOTHUE) VALUES ('NV002', 'Nguyễn Minh Thư', '001100220022', '0912345678', 'VT003', '234567891');
INSERT INTO NHANVIEN (MANV, HOTEN, CCCD, SDT, MAVT, MASOTHUE) VALUES ('NV003', 'Nguyễn Minh Thi', '001100330033', '0923456789', 'VT003', '345678912');
INSERT INTO NHANVIEN (MANV, HOTEN, CCCD, SDT, MAVT, MASOTHUE) VALUES ('NV004', 'Nguyễn Minh Đức', '001100440044', '0934567890', 'VT003', '456789123');
--TAIKHOAN
INSERT INTO TAIKHOAN VALUES ('Admin', '15e2b0d3c33891ebb0f1ef609ec419420c20e320ce94c65fbc8c3312448eb225', 'admin@gmail.com', 'CH001');

--KHACHHANG
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0001', 'Nguyễn Văn An', '0912345678');
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0002', 'Trần Thị Bình', '0987654321');
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0003', 'Lê Văn Cường', '0909090909');
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0004', 'Phạm Thị Duyên', '0933333333');
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0005', 'Hoàng Văn Đức', '0911222333');
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0006', 'Vũ Thị Hà', '0922333444');
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0007', 'Đỗ Văn Hùng', '0901222333');
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0008', 'Bùi Thị Hoa', '0913444555');
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0009', 'Trương Văn Hòa', '0944555666');
INSERT INTO KHACHHANG (MAKH, HOTEN, SDT) VALUES ('KH0010', 'Phan Thị Giang', '0900777888');
--NCU
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU001', 'Công ty Cung ứng Dược phẩm An Bình', '0203040506', '123 Đường Láng, Hà Nội', '0241234567', 'anbinh@dpharma.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU002', 'Công ty TNHH Thiết bị Y tế Việt Nam', '0203040507', '456 Nguyễn Trãi, Hà Nội', '0247654321', 'vietmed@med.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU003', 'Công ty TNHH Dược liệu Sạch', '0203040508', '789 Lê Văn Lương, Hà Nội', '0242345678', 'duoclieu@sach.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU004', 'Nhà cung cấp Thiết bị Y tế Hòa Bình', '0203040509', '321 Trần Duy Hưng, Hà Nội', '0248765432', 'hoabinh@med.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU005', 'Công ty TNHH Dược phẩm Hoa Sen', '0203040510', '654 Kim Mã, Hà Nội', '0243456789', 'hoasen@dpharma.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU006', 'Công ty Cung ứng Y tế Minh Tâm', '0203040511', '987 Phạm Văn Đồng, Hà Nội', '0249876543', 'minhtam@med.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU007', 'Nhà cung cấp Dược phẩm An Khang', '0203040512', '135 Hoàng Quốc Việt, Hà Nội', '0241234987', 'ankhang@dpharma.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU008', 'Công ty TNHH Vật tư Y tế Hòa Bình', '0203040513', '246 Cầu Giấy, Hà Nội', '0247654981', 'vatthu@med.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU009', 'Nhà cung cấp Thiết bị Dược liệu Việt', '0203040514', '357 Tây Sơn, Hà Nội', '0243567890', 'dlieu@vietmed.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU010', 'Công ty Cung ứng Thiết bị Y tế Quốc tế', '0203040515', '468 Đội Cấn, Hà Nội', '0247890123', 'quocte@med.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU011', 'Công ty TNHH Dược phẩm Hồng Phúc', '0203040516', '579 Trần Phú, Hà Nội', '0241122335', 'hongphuc@dpharma.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU012', 'Nhà cung cấp Thiết bị y tế An Bình', '0203040517', '680 Nguyễn Xiển, Hà Nội', '0245566779', 'anbinhmed@med.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU013', 'Công ty Cổ phần Dược phẩm Việt Nam', '0203040518', '781 Hoàng Hoa Thám, Hà Nội', '0249988777', 'vietpharma@dpharma.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU014', 'Nhà cung cấp Vật tư y tế Tân Bình', '0203040519', '882 Láng Hạ, Hà Nội', '0244433222', 'tanbinh@med.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU015', 'Công ty TNHH Dược phẩm Tâm An', '0203040520', '983 Thái Hà, Hà Nội', '0246677890', 'taman@dpharma.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU016', 'Nhà cung cấp Thiết bị y tế Minh Khang', '0203040521', '234 Xuân Thủy, Hà Nội', '0247788991', 'minhkhang@med.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU017', 'Công ty Cổ phần Dược phẩm Thanh Bình', '0203040522', '345 Nguyễn Văn Cừ, Hà Nội', '0248899002', 'thanhbinh@dpharma.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU018', 'Nhà cung cấp Vật tư y tế Phúc An', '0203040523', '456 Trần Khát Chân, Hà Nội', '0249900113', 'phucan@med.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU019', 'Công ty TNHH Dược phẩm Bảo An', '0203040524', '567 Bạch Mai, Hà Nội', '0241122444', 'baoan@dpharma.vn');
INSERT INTO NHACUNGUNG (MANCU, TENNCU, MASOTHUE, DIACHI, SDT, EMAIL) VALUES ('NCU020', 'Nhà cung cấp Thiết bị y tế Sài Gòn', '0203040525', '678 Lê Duẩn, Hà Nội', '0242233555', 'saigonmed@med.vn');

--HSX
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX001', 'Công ty Dược phẩm An Bình', '0102030405', '123 Đường Láng, Hà Nội', '0241234567');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX002', 'Công ty TNHH Sản xuất Dược phẩm Việt Nam', '0102030406', '456 Nguyễn Trãi, Hà Nội', '0247654321');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX003', 'Nhà máy Dược phẩm Hưng Thịnh', '0102030407', '789 Lê Văn Lương, Hà Nội', '0242345678');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX004', 'Dược phẩm Thiên Phúc', '0102030408', '321 Trần Duy Hưng, Hà Nội', '0248765432');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX005', 'Công ty Dược phẩm Hoa Sen', '0102030409', '654 Kim Mã, Hà Nội', '0243456789');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX006', 'Công ty TNHH Vitamin Việt', '0102030410', '987 Phạm Văn Đồng, Hà Nội', '0249876543');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX007', 'Nhà máy Dược phẩm An Khang', '0102030411', '135 Hoàng Quốc Việt, Hà Nội', '0241234987');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX008', 'Dược phẩm Hòa Bình', '0102030412', '246 Cầu Giấy, Hà Nội', '0247654981');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX009', 'Công ty TNHH Dược liệu Việt', '0102030413', '357 Tây Sơn, Hà Nội', '0243567890');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX010', 'Nhà máy Dược phẩm Quốc tế', '0102030414', '468 Đội Cấn, Hà Nội', '0247890123');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX011', 'Công ty Dược phẩm Minh Tâm', '0102030415', '789 Đường Láng, Hà Nội', '0241122334');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX012', 'Nhà máy Dược phẩm Thiên Long', '0102030416', '123 Nguyễn Trãi, Hà Nội', '0245566778');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX013', 'Công ty TNHH Dược phẩm Minh Đức', '0102030424', '357 Phạm Văn Đồng, Hà Nội', '0242233554');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX014', 'Dược phẩm An Bình Thịnh', '0102030417', '456 Lê Văn Lương, Hà Nội', '0249988776');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX015', 'Công ty TNHH Dược Liệu Việt Nam', '0102030418', '789 Hoàng Quốc Việt, Hà Nội', '0244433221');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX016', 'Nhà máy Dược phẩm Sức Khỏe', '0102030419', '321 Cầu Giấy, Hà Nội', '0246677889');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX017', 'Công ty TNHH Dược phẩm Thiên An', '0102030420', '654 Tây Sơn, Hà Nội', '0247788990');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX018', 'Dược phẩm Hoa Phượng', '0102030421', '987 Đội Cấn, Hà Nội', '0248899001');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX019', 'Công ty Dược liệu Sài Gòn', '0102030422', '135 Trần Duy Hưng, Hà Nội', '0249900112');
INSERT INTO HANGSANXUAT (MAHSX, TENHSX, MASOTHUE, DIACHI, SDT) VALUES ('HSX020', 'Nhà máy Dược phẩm Phúc Lợi', '0102030423', '246 Kim Mã, Hà Nội', '0241122443');

--LSP
INSERT INTO LOAISANPHAM VALUES ('LSP001', 'Thuốc giảm đau hạ sốt', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP002', 'Thuốc kháng sinh tổng hợp', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP003', 'Vitamin tổng hợp', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP004', 'Thuốc dị ứng viêm mũi', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP005', 'Thuốc tim mạch và huyết áp', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP006', 'Thuốc ho và cảm cúm', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP007', 'Thuốc dạ dày tá tràng', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP008', 'Thực phẩm chức năng bổ sung', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP009', 'Dung dịch sát khuẩn y tế', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP010', 'Thuốc bổ gan giải độc', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP011', 'Thuốc điều trị tiểu đường', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP012', 'Thuốc chống viêm', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP013', 'Thuốc hỗ trợ tiêu hóa', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP014', 'Thuốc điều trị dị ứng da', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP015', 'Thuốc hạ cholesterol', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP016', 'Thuốc an thần, ngủ ngon', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP017', 'Thuốc bổ xương khớp', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP018', 'Thuốc hô hấp và hen suyễn', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP019', 'Thuốc điều trị cao huyết áp', 'ĐANG SỬ DỤNG');
INSERT INTO LOAISANPHAM VALUES ('LSP020', 'Thuốc bổ máu, sắt', 'ĐANG SỬ DỤNG');

--SP
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP001', 'HSX001', 'LSP001', 'Paracetamol 500mg', 'Hộp 10 viên', 'VN-00123-21', 1000, 1500);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP002', 'HSX002', 'LSP002', 'Amoxicillin 500mg', 'Vỉ 10 viên', 'VN-00234-21', 800, 1800);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP003', 'HSX003', 'LSP003', 'Vitamin C 500mg', 'Hộp 100 viên', 'VN-00345-21', 1200, 250);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP004', 'HSX004', 'LSP004', 'Loratadine 10mg', 'Hộp 10 viên', 'VN-00456-21', 600, 2200);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP005', 'HSX005', 'LSP005', 'Amlodipin 5mg', 'Vỉ 10 viên', 'VN-00567-21', 500, 2700);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP006', 'HSX006', 'LSP006', 'Cảm xuyên hương', 'Hộp 10 viên', 'VN-00678-21', 900, 1200);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP007', 'HSX007', 'LSP007', 'Omeprazol 20mg', 'Hộp 14 viên', 'VN-00789-21', 700, 1715);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP008', 'HSX008', 'LSP008', 'Viên sắt Ferrovit', 'Lọ 100 viên', 'VN-00890-21', 400, 750);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP009', 'HSX009', 'LSP009', 'Dung dịch sát khuẩn Chlorhexidine', 'Chai 100ml', 'VN-00901-21', 300, 30000);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP010', 'HSX010', 'LSP010', 'Bổ gan Boganic', 'Hộp 20 viên', 'VN-01012-21', 600, 3000);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP011', 'HSX001', 'LSP011', 'Metformin 500mg', 'Hộp 30 viên', 'VN-01123-21', 700, 1167);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP012', 'HSX002', 'LSP012', 'Diclofenac 50mg', 'Hộp 20 viên', 'VN-01234-21', 500, 1400);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP013', 'HSX003', 'LSP013', 'Men tiêu hóa Lactomin Plus', 'Hộp 20 gói', 'VN-01345-21', 450, 2750);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP014', 'HSX004', 'LSP014', 'Kem bôi dị ứng Eumovate', 'Tuýp 15g', 'VN-01456-21', 300, 72000);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP015', 'HSX005', 'LSP015', 'Atorvastatin 20mg', 'Vỉ 10 viên', 'VN-01567-21', 400, 6400);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP016', 'HSX006', 'LSP016', 'Melatonin 3mg', 'Lọ 60 viên', 'VN-01678-21', 250, 1633);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP017', 'HSX007', 'LSP017', 'Glucosamin 1500mg', 'Lọ 100 viên', 'VN-01789-21', 350, 1100);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP018', 'HSX008', 'LSP018', 'Ventolin 100mcg', 'Bình xịt 200 liều', 'VN-01890-21', 300, 120000);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP019', 'HSX009', 'LSP019', 'Losartan 50mg', 'Hộp 30 viên', 'VN-01901-21', 500, 1500);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN) 
VALUES ('SP020', 'HSX010', 'LSP020', 'Tardyferon B9', 'Hộp 30 viên', 'VN-02012-21', 400, 2933);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP021', 'HSX012', 'LSP001', 'Panadol Extra', 'Hộp 20 viên', 'VN-02101-22', 600, 900);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP022', 'HSX003', 'LSP004', 'Cetirizine 10mg', 'Hộp 10 viên', 'VN-02202-22', 500, 2200);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP023', 'HSX004', 'LSP006', 'Natrilix SR', 'Hộp 30 viên', 'VN-02303-22', 400, 2267);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP024', 'HSX005', 'LSP009', 'Vitamin C 500mg', 'Hộp 10 viên sủi', 'VN-02404-22', 550, 2600);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP025', 'HSX006', 'LSP013', 'Tiêu hóa Enzyme Gold', 'Lọ 60 viên', 'VN-02505-22', 300, 1217);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP026', 'HSX007', 'LSP001', 'Efferalgan 500mg', 'Hộp 16 viên sủi', 'VN-02606-22', 500, 1250);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP027', 'HSX008', 'LSP018', 'Seretide Evohaler', 'Bình xịt 120 liều', 'VN-02707-22', 250, 200000);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP028', 'HSX009', 'LSP017', 'Jointcare Max', 'Lọ 90 viên', 'VN-02808-22', 350, 1089);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP029', 'HSX010', 'LSP015', 'Crestor 10mg', 'Hộp 28 viên', 'VN-02909-22', 400, 3750);
INSERT INTO SANPHAM (MASP, MAHSX, MALSP, TENSP, QUYCACHDONGGOI, SODANGKY, SOLUONG, GIABAN)
VALUES ('SP030', 'HSX001', 'LSP020', 'Ferrovit B9', 'Hộp 30 viên nang mềm', 'VN-03010-22', 300, 2833);

--PNH
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0001', 'NCU001', 'NV001', TO_DATE('2025-04-01','YYYY-MM-DD'), 300000);
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0002', 'NCU002', 'NV002', TO_DATE('2025-04-02','YYYY-MM-DD'), 250000);
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0003', 'NCU003', 'NV003', TO_DATE('2025-04-03','YYYY-MM-DD'), 270000);
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0004', 'NCU004', 'NV004', TO_DATE('2025-04-04','YYYY-MM-DD'), 310000);
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0005', 'NCU005', 'NV001', TO_DATE('2025-04-05','YYYY-MM-DD'), 290000);
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0006', 'NCU006', 'NV002', TO_DATE('2025-04-06','YYYY-MM-DD'), 330000);
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0007', 'NCU007', 'NV003', TO_DATE('2025-04-07','YYYY-MM-DD'), 450000);
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0008', 'NCU008', 'NV004', TO_DATE('2025-04-08','YYYY-MM-DD'), 270000);
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0009', 'NCU009', 'NV001', TO_DATE('2025-04-09','YYYY-MM-DD'), 290000);
INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
VALUES ('PNH0010', 'NCU010', 'NV002', TO_DATE('2025-04-10','YYYY-MM-DD'), 310000);
--HD
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN) VALUES
('HD0001', 'NV002', 'KH0001', TO_DATE('2025-05-01','YYYY-MM-DD'), 120000);
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN) VALUES
('HD0002', 'NV003', 'KH0002', TO_DATE('2025-05-02','YYYY-MM-DD'), 150000);
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN) VALUES
('HD0003', 'NV001', 'KH0003', TO_DATE('2025-05-03','YYYY-MM-DD'), 95000);
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN) VALUES
('HD0004', 'NV004', 'KH0004', TO_DATE('2025-05-04','YYYY-MM-DD'), 200000);
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN, TRANGTHAI) VALUES
('HD0005', 'NV001', 'KH0005', TO_DATE('2025-05-05','YYYY-MM-DD'), 180000, 'DA_HUY');
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN) VALUES
('HD0006', 'NV002', 'KH0006', TO_DATE('2025-05-06','YYYY-MM-DD'), 130000);
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN) VALUES
('HD0007', 'NV003', 'KH0007', TO_DATE('2025-05-07','YYYY-MM-DD'), 220000);
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN) VALUES
('HD0008', 'NV004', 'KH0008', TO_DATE('2025-05-08','YYYY-MM-DD'), 160000);
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN, TRANGTHAI) VALUES
('HD0009', 'NV001', 'KH0009', TO_DATE('2025-05-09','YYYY-MM-DD'), 110000, 'DA_HUY');
INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN) VALUES
('HD0010', 'NV002', 'KH0010', TO_DATE('2025-05-10','YYYY-MM-DD'), 140000);

--CTPNH
-- Chi tiết phiếu nhập hàng
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0001', 'SP001', TO_DATE('2026-04-01','YYYY-MM-DD'), 'LOT001', 100, 1050);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0001', 'SP002', TO_DATE('2026-04-01','YYYY-MM-DD'), 'LOT002', 80, 1260);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0002', 'SP003', TO_DATE('2026-04-02','YYYY-MM-DD'), 'LOT003', 120, 175);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0002', 'SP004', TO_DATE('2026-04-02','YYYY-MM-DD'), 'LOT004', 60, 1540);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0003', 'SP005', TO_DATE('2026-04-03','YYYY-MM-DD'), 'LOT005', 50, 1890);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0003', 'SP006', TO_DATE('2026-04-03','YYYY-MM-DD'), 'LOT006', 90, 840);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0004', 'SP007', TO_DATE('2026-04-04','YYYY-MM-DD'), 'LOT007', 70, 1200);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0004', 'SP008', TO_DATE('2026-04-04','YYYY-MM-DD'), 'LOT008', 40, 525);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0005', 'SP009', TO_DATE('2026-04-05','YYYY-MM-DD'), 'LOT009', 30, 21000);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0005', 'SP010', TO_DATE('2026-04-05','YYYY-MM-DD'), 'LOT010', 60, 2100);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0006', 'SP011', TO_DATE('2026-04-06','YYYY-MM-DD'), 'LOT011', 70, 816);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0006', 'SP012', TO_DATE('2026-04-06','YYYY-MM-DD'), 'LOT012', 50, 980);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0007', 'SP013', TO_DATE('2026-04-07','YYYY-MM-DD'), 'LOT013', 45, 1925);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0007', 'SP014', TO_DATE('2026-04-07','YYYY-MM-DD'), 'LOT014', 30, 50400);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0008', 'SP015', TO_DATE('2026-04-08','YYYY-MM-DD'), 'LOT015', 40, 4480);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0008', 'SP016', TO_DATE('2026-04-08','YYYY-MM-DD'), 'LOT016', 25, 1143);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0009', 'SP017', TO_DATE('2026-04-09','YYYY-MM-DD'), 'LOT017', 35, 770);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0009', 'SP018', TO_DATE('2026-04-09','YYYY-MM-DD'), 'LOT018', 30, 84000);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0010', 'SP019', TO_DATE('2026-04-10','YYYY-MM-DD'), 'LOT019', 50, 1050);
INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) VALUES
('PNH0010', 'SP020', TO_DATE('2026-04-10','YYYY-MM-DD'), 'LOT020', 40, 2053);

--CTHD
-- Chi tiết hóa đơn
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0001', 'SP001', 2, 1500);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0001', 'SP003', 3, 250);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0001', 'SP006', 5, 1200);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0002', 'SP002', 3, 1800);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0002', 'SP004', 2, 2200);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0002', 'SP008', 4, 750);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0003', 'SP005', 1, 2700);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0003', 'SP007', 2, 1715);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0004', 'SP009', 1, 30000);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0004', 'SP010', 3, 3000);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0004', 'SP012', 2, 1400);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0005', 'SP011', 4, 1167);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0005', 'SP013', 3, 2750);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0006', 'SP014', 1, 72000);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0006', 'SP015', 2, 6400);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0007', 'SP016', 3, 1633);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0007', 'SP017', 4, 1100);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0008', 'SP018', 1, 120000);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0008', 'SP019', 2, 1500);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0009', 'SP020', 3, 2933);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0010', 'SP001', 2, 1500);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0010', 'SP005', 1, 2700);
INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA) VALUES
('HD0010', 'SP010', 2, 3000);

UPDATE HOADON
SET THANHTIEN = (
    SELECT NVL(SUM(SOLUONG * GIA), 0)
    FROM CHITIETHOADON
    WHERE CHITIETHOADON.MAHD = HOADON.MAHD
);
/

UPDATE PHIEUNHAPHANG
SET THANHTIEN = (
    SELECT NVL(SUM(SLNHAP * GIANHAP), 0)
    FROM CHITIETPHIEUNHAPHANG
    WHERE CHITIETPHIEUNHAPHANG.MAPNH = PHIEUNHAPHANG.MAPNH
);
/

--OK--
CREATE OR REPLACE TRIGGER trg_set_loai_khach
BEFORE UPDATE OF DIEMTICHLUY ON KHACHHANG
FOR EACH ROW
BEGIN
    IF :NEW.DIEMTICHLUY < 100 THEN
        :NEW.LOAIKHACH := 'Bình thường';
    ELSIF :NEW.DIEMTICHLUY < 300 THEN
        :NEW.LOAIKHACH := 'Bạc';
    ELSIF :NEW.DIEMTICHLUY < 600 THEN
        :NEW.LOAIKHACH := 'Vàng';
    ELSE
        :NEW.LOAIKHACH := 'Kim cương';
    END IF;
END;

/



--OK--
CREATE OR REPLACE TRIGGER trg_insert_hoadon
AFTER INSERT ON HOADON
FOR EACH ROW
DECLARE
    diem_cong NUMBER;
BEGIN
    IF :NEW.MAKH IS NOT NULL THEN
        diem_cong := FLOOR(:NEW.THANHTIEN / 10000);
        
        UPDATE KHACHHANG
        SET DIEMTICHLUY = DIEMTICHLUY + diem_cong
        WHERE MAKH = :NEW.MAKH;
    END IF;
END;
/


CREATE OR REPLACE TRIGGER trg_kiem_tra_chi_tiet_hd
BEFORE INSERT ON CHITIETHOADON
FOR EACH ROW
DECLARE
    v_ton_kho NUMBER;
    v_trang_thai VARCHAR2(20); 
BEGIN
    -- Kiểm tra hóa đơn tồn tại và chưa hủy
    BEGIN
        SELECT TRANGTHAI INTO v_trang_thai FROM HOADON WHERE MAHD = :NEW.MAHD;
        IF v_trang_thai = 'DA_HUY' THEN
            RAISE_APPLICATION_ERROR(-20001, 'Không thể thêm vào hóa đơn đã hủy');
        END IF;
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20002, 'Hóa đơn không tồn tại');
    END;
    
    -- Kiểm tra số lượng tồn kho
    SELECT SOLUONG INTO v_ton_kho FROM SANPHAM WHERE MASP = :NEW.MASP;
    IF v_ton_kho < :NEW.SOLUONG THEN
        RAISE_APPLICATION_ERROR(-20003, 'Không đủ tồn kho');
    END IF;
    
    -- Giảm số lượng tồn kho
    UPDATE SANPHAM SET SOLUONG = SOLUONG - :NEW.SOLUONG WHERE MASP = :NEW.MASP;
END;
/



CREATE OR REPLACE TRIGGER trg_phuc_hoi_ton_kho
AFTER UPDATE OF TRANGTHAI ON HOADON
FOR EACH ROW
WHEN (NEW.TRANGTHAI = 'DA_HUY' AND OLD.TRANGTHAI != 'DA_HUY')
BEGIN
    FOR ct IN (SELECT MASP, SOLUONG FROM CHITIETHOADON WHERE MAHD = :NEW.MAHD) LOOP
        UPDATE SANPHAM SET SOLUONG = SOLUONG + ct.SOLUONG WHERE MASP = ct.MASP;
    END LOOP;
END;
/


CREATE OR REPLACE TRIGGER trg_auto_update_tonkho
AFTER INSERT OR UPDATE OR DELETE ON CHITIETPHIEUNHAPHANG
FOR EACH ROW
BEGIN
    IF INSERTING THEN
        UPDATE SANPHAM
        SET SOLUONG = SOLUONG + :NEW.SLNHAP
        WHERE MASP = :NEW.MASP;
    
    ELSIF UPDATING THEN
        UPDATE SANPHAM
        SET SOLUONG = SOLUONG + (:NEW.SLNHAP - :OLD.SLNHAP)
        WHERE MASP = :NEW.MASP;
    
    ELSIF DELETING THEN
        UPDATE SANPHAM
        SET SOLUONG = SOLUONG - :OLD.SLNHAP
        WHERE MASP = :OLD.MASP;
    END IF;
END;
/


CREATE OR REPLACE TRIGGER trg_prevent_orphan_details
BEFORE DELETE ON PHIEUNHAPHANG
FOR EACH ROW
BEGIN
    DELETE FROM CHITIETPHIEUNHAPHANG WHERE MAPNH = :OLD.MAPNH;
END;
/

CREATE OR REPLACE TRIGGER trg_kiem_tra_chi_tiet_hd
BEFORE INSERT OR UPDATE OR DELETE ON CHITIETHOADON
FOR EACH ROW
DECLARE
    v_ton_kho NUMBER;
    v_trang_thai VARCHAR2(20);
    v_chech_lech NUMBER;
BEGIN
    BEGIN
        SELECT TRANGTHAI INTO v_trang_thai FROM HOADON 
        WHERE MAHD = NVL(:NEW.MAHD, :OLD.MAHD);
        
        IF v_trang_thai = 'DA_HUY' THEN
            RAISE_APPLICATION_ERROR(-20001, 'Không thể thay đổi chi tiết hóa đơn đã hủy');
        END IF;
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20002, 'Hóa đơn không tồn tại');
    END;
    
    IF INSERTING THEN
        SELECT SOLUONG INTO v_ton_kho FROM SANPHAM WHERE MASP = :NEW.MASP;
        IF v_ton_kho < :NEW.SOLUONG THEN
            RAISE_APPLICATION_ERROR(-20003, 'Không đủ tồn kho');
        END IF;
        UPDATE SANPHAM SET SOLUONG = SOLUONG - :NEW.SOLUONG WHERE MASP = :NEW.MASP;
        
    ELSIF UPDATING THEN
        v_chech_lech := :NEW.SOLUONG - :OLD.SOLUONG;
        
        IF v_chech_lech != 0 THEN
            SELECT SOLUONG INTO v_ton_kho FROM SANPHAM WHERE MASP = :NEW.MASP;
            IF v_ton_kho < v_chech_lech THEN
                RAISE_APPLICATION_ERROR(-20004, 'Không đủ tồn kho cho thay đổi');
            END IF;
            UPDATE SANPHAM SET SOLUONG = SOLUONG - v_chech_lech WHERE MASP = :NEW.MASP;
        END IF;
        
    ELSIF DELETING THEN
        UPDATE SANPHAM SET SOLUONG = SOLUONG + :OLD.SOLUONG WHERE MASP = :OLD.MASP;
    END IF;
END;
/


--Nhiều nhân viên tạo hóa đơn cùng lúc
CREATE OR REPLACE PROCEDURE TaoHoaDon_Dongthoi (
    p_MAHD       IN CHAR,
    p_MANV       IN CHAR,
    p_MAKH       IN CHAR,
    p_NGAYBAN    IN DATE,
    p_SP_LIST    IN SYS.ODCIVARCHAR2LIST, 
    p_SL_LIST    IN SYS.ODCINUMBERLIST    
) AS
    v_TongThanhTien NUMBER(18,2) := 0;
    v_GiaBan        NUMBER(18,2);
BEGIN

    SAVEPOINT BeginHoaDon;

    INSERT INTO HOADON (MAHD, MANV, MAKH, NGAYBAN, THANHTIEN)
    VALUES (p_MAHD, p_MANV, p_MAKH, p_NGAYBAN, 0);

    -- Duyệt từng sản phẩm trong hóa đơn
    FOR i IN 1 .. p_SP_LIST.COUNT LOOP
       
        SELECT GIABAN
        INTO v_GiaBan
        FROM SANPHAM
        WHERE TRIM(MASP) = TRIM(p_SP_LIST(i))
        FOR UPDATE;
        -- Cộng tiền vào tổng hóa đơn
        v_TongThanhTien := v_TongThanhTien + (p_SL_LIST(i) * v_GiaBan);

        -- Thêm chi tiết hóa đơn (trigger sẽ tự động kiểm tra và trừ tồn kho)
        INSERT INTO CHITIETHOADON (MAHD, MASP, SOLUONG, GIA)
        VALUES (p_MAHD, p_SP_LIST(i), p_SL_LIST(i), v_GiaBan);
    END LOOP;

    UPDATE HOADON
    SET THANHTIEN = v_TongThanhTien
    WHERE MAHD = p_MAHD;

EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Lỗi: ' || SQLERRM);
        ROLLBACK TO BeginHoaDon;
        RAISE;
END;
/
--Nhân viên nhập kho đồng thời 
CREATE OR REPLACE PROCEDURE NhapKho_DongThoi(
    p_MAPNH      IN CHAR,           
    p_MANV       IN CHAR,           
    p_MANCU      IN CHAR,           
    p_NGAYNHAP   IN DATE,          
    p_SP_LIST    IN SYS.ODCIVARCHAR2LIST, 
    p_SL_LIST    IN SYS.ODCINUMBERLIST,   
    p_GIA_LIST   IN SYS.ODCINUMBERLIST,   
    p_HSD_LIST   IN SYS.ODCIDATELIST,    
    p_SOLO_LIST  IN SYS.ODCIVARCHAR2LIST  
) AS
    v_TongThanhTien NUMBER(18,2) := 0;
    v_TonKho         NUMBER;
BEGIN

    IF p_SP_LIST.COUNT != p_SL_LIST.COUNT OR
       p_SP_LIST.COUNT != p_GIA_LIST.COUNT OR
       p_SP_LIST.COUNT != p_HSD_LIST.COUNT OR
       p_SP_LIST.COUNT != p_SOLO_LIST.COUNT THEN
        RAISE_APPLICATION_ERROR(-20001, 'Danh sách đầu vào không đồng bộ.');
    END IF;
    
    SAVEPOINT BeginNhapKho;

    INSERT INTO PHIEUNHAPHANG (MAPNH, MANCU, MANV, NGAYLAPPHIEU, THANHTIEN)
    VALUES (p_MAPNH, p_MANCU, p_MANV, p_NGAYNHAP, 0);

    FOR i IN 1 .. p_SP_LIST.COUNT LOOP
            SELECT SOLUONG INTO v_TonKho
            FROM SANPHAM
            WHERE TRIM(MASP) = TRIM(p_SP_LIST(i))
            FOR UPDATE;
            
            -- Tính tổng thành tiền
            v_TongThanhTien := v_TongThanhTien + (p_SL_LIST(i) * p_GIA_LIST(i));
            
            INSERT INTO CHITIETPHIEUNHAPHANG (MAPNH, MASP, HSD, SOLO, SLNHAP, GIANHAP) 
            VALUES (p_MAPNH, p_SP_LIST(i), p_HSD_LIST(i), p_SOLO_LIST(i), p_SL_LIST(i), p_GIA_LIST(i));
    END LOOP; 
    UPDATE PHIEUNHAPHANG
    SET THANHTIEN = v_TongThanhTien
    WHERE MAPNH = p_MAPNH;
    
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Lỗi khi nhập kho: ' || SQLERRM);
        ROLLBACK TO BeginNhapKho;
        RAISE;
END;
/
